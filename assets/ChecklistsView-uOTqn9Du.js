import{d as v,R as w,u as C,r as d,f as m,_ as $,ar as h,o as p,e as g,as as t,at as F,l as n,A as V,au as y,av as k,a as S,aw as T,ax as B,aH as N,b as A,c as f,aM as E,a2 as _,aK as M,aN as P,aO as R}from"./index-C6xipBsv.js";const U=v({name:"ChecklistForm",props:{checklist:{type:Object,required:!1,default:()=>({name:""})}},components:{RecordForm:w},setup(e){C();const r=d([]),a=m(()=>!!e.checklist.id),i=m(()=>a.value?`https://api.fordsdevelopment.co.uk/daily_discipline//checklists/${e.checklist.id}`:"https://api.fordsdevelopment.co.uk/daily_discipline//checklists"),l=m(()=>a.value?"PUT":"POST");return{isEditMode:a,endpoint:i,method:l,handleSave:async o=>{window.location.reload()},value:r}}});function b(e,r,a,i,l,u){const o=h("RecordForm");return p(),g(o,{record:e.checklist,endpoint:e.endpoint,method:e.method,onSave:e.handleSave},{trigger:t(({openDialog:s})=>[F(e.$slots,"trigger",{openDialog:s},()=>[n(V,{color:"primary"},{default:t(()=>[y(k(e.isEditMode?"Edit Checklist":"Add Checklist"),1)]),_:1})])]),title:t(()=>[S("span",null,k(e.isEditMode?"Edit Checklist":"Add New Checklist"),1)]),form:t(({record:s})=>[n(T,null,{default:t(()=>[n(B,{modelValue:s.name,"onUpdate:modelValue":c=>s.name=c,label:"Name",required:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:3},8,["record","endpoint","method","onSave"])}const j=$(U,[["render",b]]),H=v({name:"ChecklistsView",components:{PageHeader:N,ChecklistForm:j},setup(){const e=d([]),r=d(null),a=d(!0),i=async()=>{const l=C(),o=await fetch("https://api.fordsdevelopment.co.uk/daily_discipline/checklists",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${l.accessToken}`}});if(o.ok){a.value=!1;const s=await o.json();e.value=s,console.log(e.value)}else{a.value=!1;const s=await o.json();r.value=s.error,r.value==="Access token has expired or is invalid."&&(l.$reset(),l.clearState(),localStorage.clear(),sessionStorage.clear())}};return A(()=>{i()}),{checklists:e}}}),L={class:"page-header"};function O(e,r,a,i,l,u){const o=h("PageHeader"),s=h("ChecklistForm");return p(),f(_,null,[S("div",L,[n(o,{title:"Checklists"})]),n(E,null,{default:t(()=>[(p(!0),f(_,null,M(e.checklists,c=>(p(),g(R,{key:c.id,to:`/checklists/${c.id}`},{default:t(()=>[n(P,null,{default:t(()=>[y(k(c.name),1)]),_:2},1024)]),_:2},1032,["to"]))),128))]),_:1}),n(s,null,{trigger:t(({openDialog:c})=>[n(V,{density:"comfortable",variant:"tonal",text:"New Checklist",class:"mr-2",onClick:c},null,8,["onClick"])]),_:1})],64)}const x=$(H,[["render",O]]);export{x as default};
